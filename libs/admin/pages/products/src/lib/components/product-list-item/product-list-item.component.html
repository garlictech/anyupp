<nb-user
  class="float-left"
  [name]="product.name | localize"
  [title]="product.description | localize"
  [picture]="(product.image || '' | awsStoragePath | async) || ''"
></nb-user>

<bgap-status-led class="ml-1" [status]="product.isVisible"></bgap-status-led>

<bgap-colorized-lane-icon
  *ngIf="productLevel === EProductLevel.UNIT"
  [laneId]="product.laneId!"
></bgap-colorized-lane-icon>

<ng-container *ngIf="hasRoleToEdit">
  <div *ngIf="!pending">
    <button
      nbButton
      shape="round"
      size="tiny"
      class="float-right"
      [title]="'common.edit' | translate"
      (click)="editProduct()"
    >
      <nb-icon icon="edit-outline"></nb-icon>
    </button>

    <ng-container *ngIf="productLevel === EProductLevel.UNIT">
      <button
        [hidden]="isLast"
        nbButton
        shape="round"
        size="tiny"
        [title]="'common.moveDown' | translate"
        class="float-right mr-2"
        (click)="moveDown()"
      >
        <nb-icon icon="chevron-down"></nb-icon>
      </button>
      <button
        [hidden]="isFirst"
        nbButton
        shape="round"
        size="tiny"
        [title]="'common.moveUp' | translate"
        class="float-right mr-2"
        (click)="moveUp()"
      >
        <nb-icon icon="chevron-up"></nb-icon>
      </button>
    </ng-container>
  </div>

  <button
    *ngIf="pending"
    nbButton
    status="danger"
    shape="round"
    size="tiny"
    class="float-right"
    (click)="extendProduct()"
  >
    <nb-icon icon="download-outline"></nb-icon>
  </button>
</ng-container>
<div class="clearfix"></div>

<div class="caption ml-5">
  <div
    class="caption d-inline-block availability-badge"
    [ngStyle]="{ opacity: variant.isAvailable ? '' : '0.7' }"
    *ngFor="let variant of variantsArray"
  >
    <strong>{{ variant.variantName | localize }}</strong> ({{
      variant.pack.size
    }}
    {{ variant.pack.unit }}) -

    <ng-container
      *ngFor="let availability of variant.availabilities; last as isLast"
    >
      <bgap-variant-availability-badge
        [availability]="availability"
        [currency]="currency"
      ></bgap-variant-availability-badge>

      <span *ngIf="!isLast"> &bull; </span>
    </ng-container>

    <bgap-status-led
      class="ml-1"
      [status]="variant.isAvailable"
    ></bgap-status-led>
  </div>

  <div class="clearfix"></div>

  <img class="allergen" src="assets/images/allergens/{{ allergen }}.svg" *ngFor="let allergen of product.allergens">

</div>
