<div class="row p-0 m-0">
  <ng-container *ngFor="let orderItem of order?.items; index as i">
    <div class="col-1 col-md-1 p-2 m-auto subtitle-2 text-right font-larger">
      {{ i + 1 }}.
    </div>
    <div class="col-11 col-md-5 p-2 m-auto subtitle-2 font-larger">
      <div>
        {{ orderItem.productName | localize }} ({{
          orderItem.variantName | localize
        }})

        <bgap-colorized-lane-icon
          [laneId]="orderItem.laneId!"
        ></bgap-colorized-lane-icon>
      </div>
      <div class="font-weight-normal" *ngIf="orderItem.configSets">
        <div *ngFor="let set of orderItem.configSets">
          {{ set.name | localize }}:
          <span *ngFor="let setItem of set.items; let last = last">
            {{ setItem.name | localize }}
            <ng-container *ngIf="!last">,</ng-container>
          </span>
        </div>
      </div>
    </div>
    <div
      class="
        col-1 col-md-1
        p-2
        m-auto
        caption
        text-right
        font-weight-bold font-larger
      "
    >
      {{ orderItem.quantity }}x
    </div>
    <div class="col-3 col-md-2 p-2 m-auto caption text-right font-larger">
      {{
        orderItem.priceShown.priceSum
          | currencyFormatter: orderItem.priceShown.currency
      }}
    </div>
    <div class="text-right p-2 col-8 col-md-3 m-auto">
      <ng-container *ngIf="isListMode('CURRENT') || isListMode('FLOOR_MAP')">
        <button
          *ngIf="isStatusLog(orderItem, 'served')"
          nbButton
          class="mr-2"
          [status]="getPlacedButtonStatus()"
          [size]="buttonSize"
          shape="round"
          (click)="resetOrderItemStatus(i)"
        >
          <nb-icon icon="arrow-ios-back-outline"></nb-icon>
        </button>

        <button
          nbButton
          [status]="getButtonStatus(orderItem.statusLog)"
          [size]="buttonSize"
          shape="round"
          class="font-larger"
          (click)="updateOrderItemStatus(i)"
        >
          {{ currentStatus(orderItem.statusLog) }}
        </button>
      </ng-container>

      <nb-badge
        class="font-larger p-2 position-static"
        [status]="getButtonStatus(orderItem.statusLog)"
        *ngIf="isListMode('HISTORY')"
        [text]="currentStatus(orderItem.statusLog)"
      ></nb-badge>
    </div>
  </ng-container>
</div>

<hr class="mt-1 mb-1" />

<div class="row p-0 m-0">
  <div class="col-1 text-right p-2 m-auto font-larger"><strong>Î£</strong></div>
  <div class="col-5 p-2 m-auto">
    <ng-container
      *ngIf="order.transaction?.status === EPaymentStatus.waiting_for_payment"
    >
      <button
        nbButton
        class="float-right mr-2"
        status="success"
        [size]="buttonSize"
        shape="round"
        (click)="updateTransactionStatus(EPaymentStatus.success)"
      >
        {{ 'common.transactionStatus.SUCCESS' | translate }}
      </button>
      <button
        nbButton
        class="float-right mr-2"
        status="danger"
        [size]="buttonSize"
        shape="round"
        (click)="updateTransactionStatus(EPaymentStatus.failed)"
      >
        {{ 'common.transactionStatus.FAILED' | translate }}
      </button>
    </ng-container>
  </div>
  <div class="col-1 text-right p-2 m-auto font-larger caption-2">
    {{ order.paymentMode.method }}
  </div>
  <!--  *ngIf="currentOrderStatus === OrderStatus.NONE"-->
  <!--div class="col-6 m-auto">
    <button
      *ngFor="let mode of unit?.paymentModes"
      nbButton
      class="float-right mr-1"
      [status]="order.paymentMode.type === mode.name ? 'success' : 'basic'"
      [size]="buttonSize"
      shape="round"
      (click)="updateOrderPaymentMethod(mode)"
    >
      {{ ('common.paymentModes.' + mode.name) | translate }}
    </button>
  </div-->

  <div class="col-2 p-2 caption text-right m-auto font-weight-bold font-larger">
    {{
      order.sumPriceShown.priceSum
        | currencyFormatter: order.sumPriceShown.currency
    }}
  </div>
  <div class="text-right p-2 col-3 m-auto">
    <button
      [nbSpinner]="workingOrderStatus"
      nbSpinnerStatus="control"
      [disabled]="workingOrderStatus"
      *ngIf="isListMode('CURRENT') || isListMode('FLOOR_MAP')"
      nbButton
      [status]="getButtonStatus(order.statusLog)"
      [size]="buttonSize"
      shape="round"
      class="font-larger"
      (click)="updateOrderStatus()"
    >
      {{ currentStatus(order.statusLog) }}
    </button>

    <nb-badge
      class="font-larger p-2 position-static"
      *ngIf="isListMode('HISTORY')"
      [text]="currentStatus(order.statusLog)"
      [status]="getButtonStatus(order.statusLog)"
    ></nb-badge>
  </div>

  <div class="col-12 p-2 pl-4">
    <button
      nbButton
      status="danger"
      [size]="buttonSize"
      shape="round"
      (click)="deleteOrder()"
      *ngIf="currentStatus(order.statusLog) === EOrderStatus.none"
    >
      <nb-icon icon="trash-2-outline"></nb-icon>
      {{ 'orders.deleteOrder' | translate }}
    </button>
  </div>
</div>

<hr />
